# Novel Reader - 读书网站开发规范

## 项目概述
开发一个定时抓取多个小说平台最新内容的读书网站，支持标签过滤、内容展示和用户收藏管理功能。

### 核心优先级
**爬虫功能是核心，必须首先实现！**

### 项目命名
- **后端项目**：`novel-reader-backend`
- **前端项目**：`novel-reader-frontend`
- **设计文档**：`/home/wuying/clawd/docs/novel-reader-design/`

## 📋 开发要求

### 1. 架构设计先行
- ✅ 正式开发前必须完成：
  - 数据库设计（ER图、表结构、字段定义）
  - 前端页面设计（页面流程图、UI布局、交互逻辑）
  - 后端接口设计（API文档、请求/响应格式）
- ✅ 设计完成后需要充分分析可行性
- ✅ 设计文档必须归档到 GitHub 仓库

### 2. Git 版本控制
- ✅ 严格使用 Git 进行版本控制
- ✅ 每个功能点都要提交到 GitHub
- ✅ 提交信息规范：`[类型] 简短描述`
  - feat: 新功能
  - fix: 修复bug
  - docs: 文档更新
  - test: 测试
  - refactor: 重构
  - style: 代码格式
  - chore: 构建/工具

### 3. 文档和测试
- ✅ 每开发一个功能点都要输出设计文档
- ✅ 设计文档归档到 GitHub（`docs/` 目录）
- ✅ 每次较大更新都要记录更新日志（CHANGELOG.md）
- ✅ README.md 要保持更新
- ✅ 每完成一个模块都要进行完整测试
- ✅ 测试通过后才合并到主分支
- ❌ 不要到最后一起提交

### 4. 代码质量
- ✅ 严格遵循对应语言的编程规范
  - Java: 遵循阿里巴巴Java开发手册 / Google Java Style
  - JavaScript/TypeScript: 遵循 Airbnb Style Guide / ESLint
  - SQL: 遵循数据库命名规范
- ✅ 使用有意义的变量名和函数名
  - 变量名：驼峰命名法 (camelCase)
  - 类名：帕斯卡命名法 (PascalCase)
  - 常量：全大写下划线分隔 (UPPER_SNAKE_CASE)
  - 方法名：动词开头，描述功能
- ✅ 注释要详细
  - 类注释：描述类的职责和用途
  - 方法注释：Javadoc 格式，包含参数说明、返回值、异常
  - 复杂逻辑：添加行内注释说明
- ✅ 代码要易读、易维护、易扩展

## 🎯 功能需求

### 数据抓取 ⭐ 核心功能（最高优先级）
- **目标平台**：
  - 刺猬猫：https://mip.ciweimao.com/
  - SF轻小说：https://book.sfacg.com/
  - 次元姬：https://www.ciyuanji.com/
  - 起点：https://www.qidian.com/
- **抓取频率**：定时任务（每2小时）
- **数据过滤**：根据标签过滤，只抓取特定标签的书籍
- **抓取内容**：
  - 唯一ID
  - 书籍名称
  - 简介
  - 作者
  - 标签
  - 封面图片
  - 最新更新时间
  - 首次抓取：前3-5章内容 + AI概括
- **爬虫后台管理**：
  - 任务管理
  - 平台配置
  - 数据浏览
  - 参数设置

### 主要功能
- **查询界面**：展示最新更新的小说列表
- **用户系统**：登录/注册
- **收藏管理**：收藏书籍、分类管理（登录后可用）
- **扩展功能**：后续增加

## 🏗️ 技术栈

### 后端（Java）
- **框架**：Spring Boot 3.x
- **数据库访问**：Spring Data JPA / MyBatis-Plus
- **定时任务**：Spring Task / XXL-Job
- **API文档**：SpringDoc (OpenAPI 3) / Knife4j
- **测试**：JUnit 5, Mockito
- **构建工具**：Maven

### 前端（待定）
**考虑因素：后续需要APP端扩展**

**选项1：Vue 3 + Vite**
- 优点：生态成熟、文档完善、学习曲线平缓
- 缺点：APP端需要单独开发或使用跨平台框架
- 适合：快速开发、维护成本低

**选项2：React + Next.js**
- 优点：SEO友好、服务端渲染、生态强大
- 缺点：学习曲线较陡
- 适合：需要SEO、服务端渲染

**选项3：Uni-app**
- 优点：一套代码多端运行（H5、小程序、APP）
- 缺点：性能不如原生框架、生态相对较弱
- 适合：强烈推荐，满足APP端需求

### 数据库 ⭐ 已确定为MySQL

**MySQL 8.0**
- 优点：轻量化、成熟稳定、事务支持好、生态完善、全文搜索支持
- 缺点：海量数据下性能瓶颈（本项目数据量不大，无影响）
- 适合：中小型项目、当前服务器环境

**原因**：用户要求轻量化，且服务器资源充足，MySQL完全满足需求

### 缓存
- **Redis**：热点数据缓存、分布式锁、限流

### 消息队列 ⭐ 暂不使用
- **暂不使用RabbitMQ**（节省300MB内存资源）
- 使用Spring定时任务直接处理
- 后续如有需要可扩展

### AI 概括
- **智谱AI / OpenAI API**：章节内容概括

## 📁 项目结构

```
novel-reader/
├── backend/                 # Java后端
│   ├── src/main/java/       # Java源码
│   │   └── com/novel/reader/
│   │       ├── controller/  # 控制器层
│   │       ├── service/     # 业务逻辑层
│   │       ├── repository/  # 数据访问层
│   │       ├── entity/      # 实体类
│   │       ├── dto/         # 数据传输对象
│   │       ├── config/      # 配置类
│   │       ├── crawler/     # 爬虫模块
│   │       ├── scheduler/   # 定时任务
│   │       └── util/        # 工具类
│   ├── src/main/resources/  # 资源文件
│   │   ├── application.yml  # 配置文件
│   │   └── db/migration/    # 数据库迁移脚本
│   ├── src/test/java/       # 测试代码
│   └── pom.xml              # Maven配置
├── frontend/                # 前端
│   ├── src/
│   │   ├── components/      # 组件
│   │   ├── views/           # 页面
│   │   ├── api/             # API封装
│   │   ├── store/           # 状态管理
│   │   └── utils/           # 工具函数
│   ├── public/
│   └── package.json
├── docs/                    # 文档
│   ├── design/              # 设计文档
│   │   ├── database.md      # 数据库设计
│   │   ├── frontend.md      # 前端设计
│   │   ├── api.md           # API接口文档
│   │   └── architecture.md  # 架构设计
│   ├── development/         # 开发文档
│   │   ├── setup.md         # 环境搭建
│   │   └── coding-guide.md  # 编码规范
│   └── deployment/          # 部署文档
├── CHANGELOG.md             # 更新日志
└── README.md                # 项目说明
```

## 🔄 开发流程

1. **需求分析** → 输出需求文档 ✅ 已完成
2. **架构设计** → 数据库、前端、API设计 ✅ 已完成
3. **设计评审** → 与用户确认 ⏳ 等待用户评审
4. **环境搭建** → 初始化项目、配置开发环境
5. **模块开发** → 按功能模块迭代开发
   - **P0（最高优先级）**：
     1. ⭐ 爬虫功能（首先实现）
        - 刺猬猫爬虫
        - SF轻小说爬虫
        - 次元姬爬虫
        - 起点爬虫
        - AI概括服务
     2. ⭐ 爬虫后台管理界面
        - 任务管理
        - 平台配置
        - 数据浏览
   - **P1（次要优先级）**：
     3. 数据库搭建（MySQL）
     4. 后端基础框架
     5. 用户系统（注册/登录）
     6. 前端基础页面
     7. 小说展示功能
     8. 收藏管理功能
6. **单元测试** → 测试每个功能点
7. **集成测试** → 模块联调测试
8. **部署上线** → 部署到服务器
9. **持续维护** → 修复bug、功能迭代

## ✅ 检查清单

每个功能点开发完成后，检查：
- [ ] 代码是否遵循规范
- [ ] 注释是否完整
- [ ] 是否有单元测试
- [ ] 是否提交到 Git
- [ ] 是否更新文档
- [ ] 是否更新 CHANGELOG
- [ ] 是否通过测试
- [ ] 是否合并到主分支

---

**严格按照此规范执行！**
